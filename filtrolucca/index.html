<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
    <title>Filtro God is Good - Final</title>
    <style>
        :root { --accent: #25D366; --record: #ff0000; --boom: #e1306c; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: #000; color: #fff; overflow: hidden; width: 100vw; height: 100dvh; font-family: sans-serif; }

        .stage { position: relative; width: 100%; height: 100%; overflow: hidden; background: #000; touch-action: none; }
        #camera { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 1; }
        #camera.mirrored { transform: scaleX(-1); }

        /* Previews */
        #editorCanvas, #canvasPreview, #videoPreview { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: contain; z-index: 6; background: #000; display: none; }
        #molduraImagePreview { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: contain; object-position: bottom; pointer-events: none; z-index: 10; display: block; }

        /* UI Layer */
        .ui-layer { position: absolute; inset: 0; pointer-events: none; z-index: 40; display: flex; flex-direction: column; justify-content: space-between; padding: 40px 20px; }
        
        /* Ajuste do topo para garantir que os botÃµes apareÃ§am */
        .top-bar { display: flex; justify-content: space-between; align-items: flex-start; pointer-events: auto; z-index: 50; }
        
        .moldura-selector { display: flex; gap: 10px; }
        .btn-m { padding: 10px 20px; background: rgba(0,0,0,0.6); border: 2px solid rgba(255,255,255,0.3); border-radius: 20px; color: #fff; cursor: pointer; font-weight: bold; }
        .btn-m.active { border-color: var(--accent); background: rgba(37, 211, 102, 0.4); }

        .controls-bottom { display: flex; flex-direction: column; align-items: center; pointer-events: auto; width: 100%; }
        .custom-controls-wrapper { position: relative; width: 100%; display: flex; justify-content: center; align-items: center; min-height: 160px; }
        .arte-botoes-bg { position: absolute; bottom: -10px; width: 100vw; max-width: 500px; pointer-events: none; }
        
        .capture-controls { position: relative; z-index: 2; display: flex; gap: 10px; }
        .btn-hidden { opacity: 0; width: 60px; height: 60px; }
        
        #startScreen { position: absolute; inset: 0; background: #000 url('capajpg.jpg') center/cover; display: flex; align-items: center; justify-content: center; z-index: 100; }
        #startBtn { padding: 25px 55px; font-size: 24px; border-radius: 50px; border: none; background: #FF5722; color: #fff; cursor: pointer; }
    </style>
</head>
<body>

<div class="stage" id="mainStage">
    <video id="camera" autoplay playsinline muted></video>
    <canvas id="editorCanvas"></canvas>
    <canvas id="canvasPreview"></canvas>
    <canvas id="canvasFinal"></canvas>
    <video id="videoPreview" playsinline controls loop></video>
    <img id="molduraImagePreview" src="moldura1.png" />
    
    <div class="ui-layer" id="cameraUI" style="display:none;">
        <div class="top-bar">
            <button class="btn-m" id="switchBtn">ðŸ”„</button>
            <div class="moldura-selector">
                <button id="m1Btn" class="btn-m active">FOTO 1</button>
                <button id="m2Btn" class="btn-m">FOTO 2</button>
            </div>
        </div>
        
        <div class="controls-bottom">
            <div class="custom-controls-wrapper">
                <img src="botoes.png" class="arte-botoes-bg">
                <div class="capture-controls">
                    <button id="galleryBtn" class="btn-hidden"></button>
                    <input type="file" id="fileInput" accept="image/*" style="display:none;">
                    <button id="capturePhotoBtn" class="btn-hidden"></button>
                    <button id="captureVideoBtn" class="btn-hidden"></button>
                    <button id="boomerangBtn" class="btn-hidden"></button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="startScreen"><button id="startBtn">INICIAR CÃ‚MERA</button></div>
</div>

<script>
// Mantendo a lÃ³gica de molduras
const MOLDURAS = { 'm1': 'moldura1.png', 'm2': 'moldura2.png' };
let currentKey = 'm1';

// LÃ³gica de troca de moldura
function setMoldura(key, btn) {
    document.querySelectorAll('.btn-m').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    currentKey = key;
    document.getElementById('molduraImagePreview').src = MOLDURAS[key];
}

document.getElementById('m1Btn').onclick = (e) => setMoldura('m1', e.target);
document.getElementById('m2Btn').onclick = (e) => setMoldura('m2', e.target);

// Iniciar CÃ¢mera
document.getElementById('startBtn').onclick = () => {
    document.getElementById('startScreen').style.display = 'none';
    document.getElementById('cameraUI').style.display = 'flex';
    navigator.mediaDevices.getUserMedia({video: true, audio: true}).then(s => {
        document.getElementById('camera').srcObject = s;
    });
};
</script>
</body>
</html>
